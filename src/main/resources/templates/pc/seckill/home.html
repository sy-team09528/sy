<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title th:text="${title}"></title>

<!-- 引入layui框架和 jq框架 -->
<div th:include="/common/layui"></div>
<div th:include="/common/jq"></div>
<!-- 引入layui框架和 jq框架 -->

<link rel="stylesheet" href="/css/pc/base.css?v=11" />

<script	src="/echarts/echarts.min.js"></script>

</head>
<script>
</script>
<body>

<div class="wrap">

<!-- 导航 -->
<div th:include="/pc/common/daohang" >
</div>
<!-- 导航 -->

<div class="model" style="background-color: #f2f2f2;" >
	<div class="content" style="min-height: 600px; padding-top: 21px; padding-bottom: 20px;">
 		
 		
 		
 		<h1 style="margin-bottom: 15px; font-size: 22px; border-bottom:4px solid #8BC34A; display: inline-block; ">正在秒杀</h1>
 		
 		
 		<div style="margin-top: 10px; overflow: hidden; min-height: 500px;">
			<div style=" border: 1px solid #c2c2c2;  border-radius: 15px; padding:10px; margin-bottom: 5px;display: flex;display: -webkit-flex;" th:each="seckillVO : ${seckillVOs}"  >
				<a th:href="|/venue/${seckillVO.venue_id}|"><img style="width: 150px; height: 150px;" th:src="${seckillVO.imageUrl}" /></a>
				<div style="overflow: hidden; flex:1;-webkit-flex:1; padding-left: 10px;">
					<div style="font-size: 18px; font-weight: bold;"><a th:href="|/venue/${seckillVO.venue_id}|"  th:text="${seckillVO.title}"></a></div>
					<div style="color: #5d5d5d;">
						<span style="margin-right: 15px;" th:text="|创建时间：${#dates.format(seckillVO.create_date_time, 'yyyy-MM-dd HH:mm:ss')}|">创建时间：2119-11-55 12：22</span>
						<span style="margin-right: 15px;" th:text="|开始时间：${#dates.format(seckillVO.start_date_time, 'yyyy-MM-dd HH:mm:ss')}|">创建时间：2119-11-55 12：22</span>
						<span style="margin-right: 15px;" th:text="|结束时间：${#dates.format(seckillVO.end_date_time, 'yyyy-MM-dd HH:mm:ss')}|">创建时间：2119-11-55 12：22</span>
<!--						<span style="display: none" th:text=""></span>-->
					</div>
					<div>
						<div id="id" style="margin-right: 15px;" th:text="|${seckillVO.venue_id}|"></div>
					<a class="layui-btn layui-btn-xs" id="pay_btn" type="button" onclick="seckill()"><i class="layui-icon">&#xe609;</i>抢购</a>
					</div>
				</div>
			</div>
 		</div>
 		
 	 	
	</div> <!-- content结束标签 -->
</div><!--  model 结束标签 -->

<!-- 底部 内容 模块 -->
<div  th:include="/pc/common/foot">
</div>
<!-- 底部 内容 模块 -->
	
</div>
</body>

<script>

	var memberId = '[[${session.member?.id}]]';
	function seckill(){
		var id=$('#id').text();
		var md5=1;
		console.log($('#id').text());
	if(memberId==""){
		layer.msg("请先登录");
	}else {

		$.post('/seckill/seckillRun/'+id+'/'+md5,function (result) {
			layer.closeAll();
			if(result.success){
				layer.alert('订单创建成功', {
					skin: 'layui-layer-lan' //样式类名
					,closeBtn: 0
				}, function(){
					layer.closeAll();
					$("#pay_btn").attr("onclick","void();");
					$("#pay_btn").text("订单创建成功");
					window.location.href = "/order/"+result.orderId;
				});
			}else{
				layer.msg(result.msg);
			}
		}, 'json');
	}
}

</script>

<script>
	layui.use([ 'laydate', 'laypage', 'layer', 'table', 'carousel',
			'upload', 'element' ], function() {
		var laydate = layui.laydate //日期
		, laypage = layui.laypage //分页
		,layer = layui.layer //弹层
		, table = layui.table //表格
		, carousel = layui.carousel //轮播
		, upload = layui.upload //上传
		, element = layui.element; //元素操作

		  
	});
</script>
</html>